{{-- Krok 2: Do≈õwiadczenie z zwierzƒôtami - Architektura v3.0 --}}
<div class="max-w-2xl mx-auto" x-data="wizardStep2()" x-init="init()"
     @ai-suggestion-applied.window="if($event.detail.field === 'experienceDescription') { syncFromLivewire(); console.log('üéØ Experience AI suggestion applied, syncing...'); }">

    {{-- Header --}}
    <div class="text-center mb-8">
        <h1 class="text-2xl font-bold text-gray-900 mb-2">Jakie masz do≈õwiadczenie z zwierzƒôtami?</h1>
        <p class="text-gray-600 text-lg">Pom√≥≈º nam lepiej zrozumieƒá Twoje umiejƒôtno≈õci i wiedzƒô.</p>
    </div>

    <div class="space-y-8">
        {{-- Pet Experience Types --}}
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-4">
                Rodzaje do≈õwiadczenia *
            </label>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                @foreach([
                    'own_pets' => ['W≈Çasne zwierzƒôta', 'üè†'],
                    'family_pets' => ['Zwierzƒôta rodziny/przyjaci√≥≈Ç', 'üë®‚Äçüë©‚Äçüëß‚Äçüë¶'],
                    'volunteering' => ['Wolontariat w schronisku', '‚ù§Ô∏è'],
                    'professional' => ['Praca zawodowa', 'üíº'],
                    'training' => ['Kursy/szkolenia', 'üìö'],
                    'veterinary' => ['Do≈õwiadczenie weterynaryjne', '‚öïÔ∏è'],
                ] as $value => $info)
                    <label class="wizard-checkbox-tile"
                           data-experience="{{ $value }}"
                           :class="isPetExperienceSelected('{{ $value }}') ? 'selected' : ''"
                           @click.prevent="togglePetExperience('{{ $value }}')">
                        <input type="checkbox"
                               value="{{ $value }}"
                               class="sr-only">
                        <div class="flex items-center w-full">
                            <span class="wizard-checkbox-emoji">{{ $info[1] }}</span>
                            <span class="wizard-checkbox-text">{{ $info[0] }}</span>

                            {{-- Checkmark icon --}}
                            <span class="wizard-checkbox-icon">
                                <div data-svg-icon="check" data-svg-size="16x16" data-svg-classes="text-white"></div>
                            </span>
                        </div>
                    </label>
                @endforeach
            </div>
            @error('petExperience')
                <p class="mt-2 text-sm text-red-600 flex items-center">
                    <span data-svg-icon="exclamation" data-svg-size="16x16" data-svg-classes="text-red-600 mr-1"></span>
                    {{ $message }}
                </p>
            @enderror
        </div>

        {{-- Years of Experience --}}
        <div>
            <label for="yearsOfExperience" class="block text-sm font-medium text-gray-700 mb-2">
                Ile lat do≈õwiadczenia masz z zwierzƒôtami? *
            </label>
            <select :value="yearsOfExperience"
                    @change="updateYearsOfExperience($event.target.value)"
                    id="yearsOfExperience"
                    class="w-full px-4 py-3 text-base border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                <option value="">Wybierz zakres...</option>
                <option value="less_than_1">Mniej ni≈º 1 rok</option>
                <option value="1_to_3">1-3 lata</option>
                <option value="3_to_5">3-5 lat</option>
                <option value="5_to_10">5-10 lat</option>
                <option value="more_than_10">Wiƒôcej ni≈º 10 lat</option>
            </select>
            @error('yearsOfExperience')
                <p class="mt-2 text-sm text-red-600 flex items-center">
                    <span data-svg-icon="exclamation" data-svg-size="16x16" data-svg-classes="text-red-600 mr-1"></span>
                    {{ $message }}
                </p>
            @enderror
        </div>

        {{-- Experience Description --}}
        <div>
            <div class="flex items-center justify-between mb-2">
                <label for="experienceDescription" class="text-sm font-medium text-gray-700">
                    Opisz swoje do≈õwiadczenie *
                </label>
                <x-ui.tooltip position="top" trigger="hover" theme="primary" size="sm">
                    <div class="flex items-center cursor-pointer hover:scale-105 transition-transform duration-200"
                         @click="$wire.showAIPanel = !$wire.showAIPanel">
                        <div class="w-8 h-8 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center mr-3">
                            <span data-svg-icon="settings" data-svg-size="16x16" data-svg-classes="text-white"></span>
                        </div>
                        <h3 class="font-semibold text-gray-900 text-sm">AI Assistant</h3>
                    </div>

                    <x-slot name="tooltip">
                        ü§ñ Otw√≥rz AI Assistant
                    </x-slot>
                    <x-slot name="subtitle">
                        Kliknij aby otworzyƒá panel z pomocƒÖ AI i wskaz√≥wkami
                    </x-slot>
                </x-ui.tooltip>
            </div>

            <div class="relative">
                <textarea
                    :value="experienceDescription"
                    @input.debounce.500ms="updateExperienceDescription($event.target.value)"
                    id="experienceDescription"
                    rows="6"
                    :class="getTextareaClasses()"
                    class="w-full px-4 py-3 text-base border border-gray-300 rounded-xl resize-none focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-all duration-300"
                    placeholder="Np. Mam 5 lat do≈õwiadczenia w opiece nad psami r√≥≈ºnych ras. Pracowa≈Çem w schronisku dla zwierzƒÖt, gdzie zdoby≈Çem do≈õwiadczenie w karmnieniu, spacerach oraz podstawowej opiece medycznej. Dodatkowo uko≈Ñczy≈Çem kurs behawiorysty ps√≥w..."
                    maxlength="1000"></textarea>

                {{-- Character Counter with Animation --}}
                <div class="absolute bottom-3 right-3 flex items-center space-x-2">
                    <span x-show="isDescriptionValid"
                          x-transition:enter="transition ease-out duration-200"
                          x-transition:enter-start="opacity-0 scale-95"
                          x-transition:enter-end="opacity-100 scale-100"
                          class="text-emerald-600">
                        <span data-svg-icon="check" data-svg-size="16x16" data-svg-classes="text-emerald-600"></span>
                    </span>
                    <span class="text-xs transition-colors duration-200"
                          :class="getProgressClasses()"
                          x-text="`${characterCount}/1000`"></span>
                </div>
            </div>

            @error('experienceDescription')
                <p class="mt-2 text-sm text-red-600 flex items-center">
                    <span data-svg-icon="exclamation" data-svg-size="16x16" data-svg-classes="text-red-600 mr-1"></span>
                    {{ $message }}
                </p>
            @enderror

            {{-- Progress Indicator with Animation --}}
            <div class="mt-3 pt-3 border-t border-gray-100">
                <div class="flex items-center justify-between text-sm">
                    <div class="flex items-center"
                         :class="getProgressClasses()">
                        <span data-svg-icon="check-circle" data-svg-size="16x16"
                              class="mr-2 transition-colors duration-200"
                              :class="isDescriptionValid ? 'text-emerald-500' : 'text-gray-400'"></span>
                        <span x-text="getValidationMessage()"></span>
                    </div>

                    {{-- Animated Progress Bar --}}
                    <div class="w-24 h-2 bg-gray-200 rounded-full overflow-hidden">
                        <div class="h-full rounded-full transition-all duration-300 ease-out"
                             :style="getProgressBarStyle()"
                             :class="{
                                 'bg-gradient-to-r from-emerald-400 to-emerald-600': characterCount >= 100,
                                 'bg-gradient-to-r from-blue-400 to-blue-600': characterCount < 100 && characterCount > 0,
                                 'bg-gray-300': characterCount === 0
                             }"></div>
                    </div>
                </div>
            </div>
        </div>

        {{-- Motivational Tips --}}
        <div x-show="hasStartedTyping && !isDescriptionValid"
             x-transition:enter="transition ease-out duration-300 delay-150"
             x-transition:enter-start="opacity-0 transform translate-y-2"
             x-transition:enter-end="opacity-100 transform translate-y-0"
             class="bg-blue-50 border border-blue-200 rounded-lg p-4">
            <h4 class="text-sm font-medium text-blue-900 mb-2">üí° Wskaz√≥wki co napisaƒá:</h4>
            <ul class="text-sm text-blue-700 space-y-1">
                <li>‚Ä¢ Jakie zwierzƒôta znasz najlepiej?</li>
                <li>‚Ä¢ Czy masz do≈õwiadczenie zawodowe?</li>
                <li>‚Ä¢ Uko≈Ñczy≈Çe≈õ jakie≈õ kursy lub szkolenia?</li>
                <li>‚Ä¢ Jakie sytuacje trudne ju≈º rozwiƒÖzywa≈Çe≈õ?</li>
            </ul>
        </div>

        {{-- Experience Summary --}}
        <div x-show="petExperience.length > 0"
             class="mt-6 p-4 bg-emerald-50 border border-emerald-200 rounded-lg">
            <h4 class="font-medium text-emerald-900 mb-2">Twoje do≈õwiadczenie:</h4>
            <div class="text-emerald-800 space-y-1">
                <p x-text="`Wybrane typy: ${petExperience.length}`"></p>
                <div x-show="yearsOfExperience" class="text-sm">
                    ‚úì Lata do≈õwiadczenia okre≈õlone
                </div>
                <div x-show="isDescriptionValid" class="text-sm">
                    ‚úì Szczeg√≥≈Çowy opis do≈õwiadczenia
                </div>
            </div>
        </div>
    </div>
</div>

{{--
    ‚úÖ ARCHITEKTURA v3.0 - EXTERNAL COMPONENT

    Komponent wizardStep2 zosta≈Ç przeniesiony do zewnƒôtrznego pliku:
    üìÅ resources/js/components/wizard-step-2-v3.js

    Nowa architektura v3.0:
    - ‚úÖ Stateless components (brak lokalnego state)
    - ‚úÖ Single Source of Truth przez window.WizardState
    - ‚úÖ Eliminacja duplikacji zmiennych miƒôdzy krokami
    - ‚úÖ Centralized state management

    Import w app.js: import './components/wizard-step-2-v3';

    Wszystkie zmienne i metody sƒÖ teraz computed properties z globalnego state:
    - petExperience, yearsOfExperience, experienceDescription
    - characterCount, isDescriptionValid, hasStartedTyping
    - togglePetExperience(), isPetExperienceSelected()
    - updateYearsOfExperience(), updateExperienceDescription()
    - getTextareaClasses(), getProgressClasses()
    - syncFromLivewire() dla AI suggestions
--}}